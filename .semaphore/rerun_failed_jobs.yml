version: v1.0
name: Rerun failed jobs
agent:
  machine:
    type: f1-standard-2
    os_image: ubuntu2204

execution_time_limit:
  minutes: 10

blocks:
  - name: Rerun failed jobs
    dependencies: []
    task:
      jobs:
        - name: Rerun failed jobs
          commands:
            - export PIPELINE=$(sem get workflows $SEMAPHORE_WORKFLOW_ID -i $SEMAPHORE_PROJECT_ID | tail -n 1 | awk '{print $1}')
            - sem rebuild pipeline $PIPELINE
