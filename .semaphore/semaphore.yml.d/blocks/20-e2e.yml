- name: E2E tests
  run:
    when: "${CHANGE_IN(e2e,node,typha,apiserver,cni-plugin,pod2daemon,calicoctl,kube-controllers,goldmane,whisker,whisker-backend)}"
  dependencies:
    - Prerequisites
  task:
    env_vars:
      - name: BUILD_CACHE_GROUP
        value: "e2e-tests"
    agent:
      machine:
        type: f1-standard-4
        os_image: ubuntu2004
    jobs:
      - name: "E2E tests: Conformance"
        commands:
          - .semaphore/run-and-monitor e2e-test.log make e2e-test
        env_vars:
          - name: STORE_BUILD_CACHE
            value: "true"
