- name: Release tooling
  run:
    when: "${CHANGE_IN(release)}"
  execution_time_limit:
    minutes: 30
  dependencies:
    - Prerequisites
  task:
    prologue:
      commands:
        - cd release
    jobs:
      - name: "Release tooling: CI"
        commands:
          - ../.semaphore/run-and-monitor release-ci.log make ci
          - 'test-results publish --name "Release tool: UT" ./report/*.xml || true'
      - name: "Release tooling: build"
        commands:
          - ../.semaphore/run-and-monitor release-build.log make build
          - cache store release-${SEMAPHORE_GIT_SHA} bin
